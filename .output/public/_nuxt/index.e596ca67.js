import{n as R,r as D,q as S,o as n,c as p,b as s,w as t,u as r,s as u,d as h,t as d,a as e,F as y,y as N,z as k,C as E,B as G}from"./entry.a8ea04dc.js";import{u as j}from"./auth.cb07611c.js";import{a as b,g as J,b as K}from"./formatter.b9064c7a.js";import{h as Q}from"./moment.fbc5633a.js";import{b as U,d as W}from"./VCard.73ffbd1f.js";import{V as g,a as f}from"./VRow.be53b986.js";import{V as T,a as C,b as L}from"./VList.a955bb07.js";import{V as z}from"./VBtn.fb6611c3.js";import{V as X}from"./VTable.c658405d.js";import{V as Z}from"./VMenu.61502ef3.js";import"./tag.19ec8209.js";import"./VImg.e08626a0.js";import"./VAvatar.28b1b839.js";/* empty css              */import"./index.2e760ea7.js";import"./ssrBoot.73ea425f.js";import"./VDivider.bce6a8e5.js";import"./forwardRefs.d6ed2341.js";import"./scopeId.280ebac7.js";const tt=e("h6",{class:"text-h6"}," Agenda ",-1),et=e("p",{class:"body2 text-medium-emphasis"}," Pressione um dos itens para expandir ",-1),at=e("b",null,"Lab:",-1),st={class:"text-body1"},ot={class:"body2 text-medium-emphasis"},lt=e("p",{class:"body2 text-medium-emphasis"}," Não há materiais para este dia. ",-1),nt=e("thead",null,[e("tr",null,[e("th",{class:"text-left"}," Laboratório "),e("th",{class:"text-right"}," Por "),e("th",{class:"text-left"}," A partir "),e("th",{class:"text-left"}," Até "),e("th",{class:"text-right"},"Ações")])],-1),it=["onClick"],rt={class:"text-right text-body2 text-medium-emphasis"},dt={class:"text-left text-caption text-medium-emphasis"},ut={class:"text-left text-caption text-medium-emphasis"},ct={class:"text-right"},Tt=R({__name:"index",async setup(mt){let V,v;const _=j(),w=D([]),o=D(null);async function A(l){l===null?o.value=null:o.value={...l,materials:await $fetch("/api/labs/schedule-materials",{method:"get",headers:{Authorization:`Bearer ${_.token}`},params:{appointment_id:l.id}})}}async function M(l){await $fetch("/api/labs/schedule-cancel",{method:"post",headers:{Authorization:`Bearer ${_.token}`},body:{id:l}}),await F()}async function Y(l){await G(`/dashboard/schedules/${l}/give-back`)}async function O(){return await $fetch("/api/labs/schedules",{method:"get",headers:{Authorization:`Bearer ${_.token}`}})}async function F(){w.value=(await O()).map(({created_at:l,full_name:c,scheduled_from:a,scheduled_to:i,...x})=>{const m="DD/MM/YYYY HH:mm",P=b(a,m),q=b(i,m);let $=!1;const B=J(a);B&&B.utc().unix()>Q().utc().unix()&&($=!0);const H=K(c),I=b(l,m);return{...x,full_name:c,firstName:H,isFuture:$,createdDate:I,scheduledTo:q,scheduledFrom:P,scheduled_from:a,scheduled_to:i}})}return[V,v]=S(()=>F()),await V,v(),(l,c)=>(n(),p(y,null,[tt,et,s(g,null,{default:t(()=>[r(o)?(n(),u(f,{key:0},{default:t(()=>[s(U,{variant:"flat","min-width":"400",class:"mx-auto","prepend-icon":"mdi-calendar"},{title:t(()=>[at,h(" "+d(r(o).name),1)]),default:t(()=>[s(W,null,{default:t(()=>[e("p",st,d(r(o).scheduledFrom)+" / "+d(r(o).scheduledTo),1),e("p",ot," Criado por "+d(r(o).full_name)+" em "+d(r(o).createdDate),1),r(o).materials.length>0?(n(),u(g,{key:0},{default:t(()=>[s(f,null,{default:t(()=>[s(T,{lines:"one"},{default:t(()=>[(n(!0),p(y,null,N(r(o).materials,({id:a,name:i,quantity:x},m)=>(n(),u(C,{key:a,title:m+1+") "+i,subtitle:"quantidade: "+x},null,8,["title","subtitle"]))),128))]),_:1})]),_:1})]),_:1})):(n(),u(g,{key:1},{default:t(()=>[s(f,null,{default:t(()=>[lt]),_:1})]),_:1})),s(z,{color:"primary",class:"mt-2",variant:"tonal",onClick:c[0]||(c[0]=a=>A(null))},{default:t(()=>[h(" Fechar ")]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0),s(f,null,{default:t(()=>[s(X,{class:"mt-2"},{default:t(()=>[nt,e("tbody",null,[(n(!0),p(y,null,N(r(w),a=>(n(),p("tr",{key:a.id,onClick:i=>A(a),style:{cursor:"pointer"}},[e("td",null,d(a.name),1),e("td",rt,d(a.firstName),1),e("td",dt,d(a.scheduledFrom),1),e("td",ut,d(a.scheduledTo),1),e("td",ct,[s(Z,null,{activator:t(({props:i})=>[s(z,E({color:"primary",variant:"tonal"},i),{default:t(()=>[h(" Ações ")]),_:2},1040)]),default:t(()=>[s(T,null,{default:t(()=>[a.isFuture?(n(),u(C,{key:0,onClick:i=>M(a.id)},{default:t(()=>[s(L,null,{default:t(()=>[h("Cancelar")]),_:1})]),_:2},1032,["onClick"])):k("",!0),a.isFuture===!1?(n(),u(C,{key:1,onClick:i=>Y(a.id)},{default:t(()=>[s(L,null,{default:t(()=>[h("Devolver materiais")]),_:1})]),_:2},1032,["onClick"])):k("",!0)]),_:2},1024)]),_:2},1024)])],8,it))),128))])]),_:1})]),_:1})]),_:1})],64))}});export{Tt as default};
